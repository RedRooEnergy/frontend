08.02 — Audit Logging & Event Model
1. Purpose

This document defines the authoritative audit logging and event model enforced by the Immutable Core. The audit system is the single source of truth for who did what, when, why, and under which authority, and must support deterministic replay, forensic reconstruction, and regulator inspection.

2. Audit Doctrine

If it is not audited, it did not happen.

Audit logging is:
• Mandatory
• Non-bypassable
• Deterministic
• Immutable

No subsystem, UI, or integration may suppress or alter audit events.

3. Scope of Audit Coverage

The Core must emit audit events for, at minimum:

• Authentication attempts (success/failure)
• Role and permission changes
• Record creation, lock, supersession, revocation
• State transitions
• Change control actions
• Configuration changes affecting enforcement
• Security-relevant failures
• Extension registration and de-registration

Business-level events may be logged by Extensions, but Core events are authoritative.

4. Event Classification

Audit events are classified into immutable categories:

• IDENTITY_EVENT
• AUTHORIZATION_EVENT
• GOVERNANCE_EVENT
• DATA_IMMUTABILITY_EVENT
• CHANGE_CONTROL_EVENT
• SECURITY_EVENT
• SYSTEM_EVENT

Each event belongs to exactly one category.

5. Event Structure (Canonical)

Every audit event must contain the following fields:

• event_id (globally unique, immutable)
• event_type (from classification)
• event_action (verb phrase, deterministic)
• actor_id (immutable identity reference)
• actor_role (role at time of action)
• target_type (record, system, policy, etc.)
• target_id (immutable reference)
• timestamp_utc (authoritative clock)
• origin (core, extension name)
• result (success, blocked, failed)
• justification_reference (if applicable)
• previous_hash (for chaining)
• event_hash (deterministic hash of event)

Optional fields are not permitted unless explicitly approved.

6. Deterministic Ordering

Audit events must be:

• Time-ordered using a monotonic clock
• Sequenced deterministically
• Resistant to reordering

Where concurrency exists, sequence numbers are mandatory.

7. Hash Chaining

Audit events must be hash-chained:

• Each event references the previous event hash
• Chain resets only under approved rotation rules
• Breaks in the chain are detectable and logged

Hash algorithms must be fixed and documented.

8. Immutability Rules

Once written:

• Audit events cannot be edited
• Audit events cannot be deleted
• Audit events cannot be hidden

Retention rules govern visibility, not existence.

9. Actor Attribution Rules

Every event must have an actor:

• Human user
• System process
• Scheduled job

Anonymous actions are prohibited.

System actors must have explicit identities.

10. Failure & Blocked Events

Attempted violations must be logged as events:

• Unauthorized access attempts
• Immutability violations
• Change control bypass attempts

Blocked actions are first-class audit records.

11. Extension Interaction

Extensions may:

• Emit extension-scoped audit events
• Subscribe to Core audit streams

Extensions may not:
• Modify Core audit records
• Filter Core events
• Suppress Core events

12. Audit Read Access

Read access is governed by role:

• Administrators: full read
• Auditors: scoped read
• Regulators: export-only
• Operators: limited contextual read

No role has write access.

13. Export & Replay Capability

The audit system must support:

• Time-bound exports
• Hash-verifiable bundles
• Deterministic replay for reconstruction

Exports must include:
• Events
• Hash chain metadata
• Verification instructions

14. Performance Constraints

Audit logging must:

• Never block Core enforcement
• Fail closed (deny action if audit cannot be written)
• Remain consistent under load

Dropped events are unacceptable.

15. Incident & Breach Alignment

Audit logs are the primary input for:

• Incident response
• Breach analysis
• Regulator notification
• Post-incident review

All incident timelines must be reconstructable from audit data alone.

16. Non-Functional Guarantees

The audit model prioritises:

• Completeness over verbosity
• Determinism over convenience
• Integrity over performance

17. Status

Status: DRAFT
Phase: 8 — Immutable Core Platform
Upstream Dependency: 08.01 — Immutable Core Platform Specification
Downstream Dependency: 08.03 — Identity & Authentication Core