# Freight Exception Admin Review Model
Version: v1.0 (PROPOSED)  
Scope: Admin governance model for freight exceptions; non-enforcing runtime

## Purpose
- Define how admins review, triage, and resolve freight exception cases.
- Provide accountable decision records without changing live freight or escrow behavior.
- Establish regulator-grade traceability for every admin action.

## Review Principles
- Decisions must be evidence-linked.
- No silent status edits; all updates emit immutable review events.
- No override without `approvalId` + rationale.
- Admin actions in this phase are observational/governance only.

## Role Matrix
- `freight`:
  - create case
  - attach evidence
  - request review
- `admin`:
  - triage queue
  - assign owner
  - request additional evidence
  - record override decision (non-enforcing)
  - resolve/close case
- `regulator`:
  - read-only replay/export access

## Queue Model (Admin Dashboard)
- Default queue filters:
  - status (`OPEN`, `IN_REVIEW`, `ACTION_REQUIRED`)
  - severity
  - age bucket (`<24h`, `24-72h`, `>72h`)
  - trigger event
  - supplier/freight partner
- Sorting:
  - `CRITICAL` first, then oldest open age.
- Priority SLA targets:
  - `CRITICAL`: first review within 4h
  - `HIGH`: first review within 12h
  - `MEDIUM/LOW`: first review within 48h

## Case Detail Requirements
- Header:
  - `exceptionId`, tenant/order/shipment references
  - current status, severity, owner
  - linked audit run (`runId`, trigger, ruleSetVersion)
- Timeline:
  - append-only event stream with actor/time/reason
- Evidence panel:
  - evidence list with content hashes and references
- Decision panel:
  - allowed next actions for current state
  - required rationale fields

## Admin Action Contract
1. `Assign Case`
- Requires `ownerId`
- Emits `ASSIGNED` event

2. `Request Evidence`
- Requires `reasonCode`, `requestedEvidenceCodes[]`
- Moves status to `ACTION_REQUIRED`
- Emits `EVIDENCE_REQUESTED` event

3. `Record Override` (non-enforcing)
- Requires `approvalId`, `decisionType`, `rationale`
- Emits `ADMIN_OVERRIDE_RECORDED`
- Does not alter escrow/freight state in current phase

4. `Resolve Case`
- Requires `resolutionCode`, `resolutionSummary`
- Status: `IN_REVIEW` -> `RESOLVED`
- Emits `CASE_RESOLVED`

5. `Close Case`
- Allowed from `RESOLVED`
- Requires closure note
- Emits `CASE_CLOSED`

## Decision Data Model
- `reviewDecisionId`
- `exceptionId`, optional `eventId`
- `decisionType`
- `approvalId` (mandatory for overrides/manual close)
- `rationale`
- `decidedAtUtc`
- `decidedByRole`, `decidedById`
- `evidenceManifestHash`
- `idempotencyKey`

## Governance Invariants
- No transition outside the approved state machine.
- No case close while required evidence request is outstanding.
- No override record without `approvalId`.
- All actions stamped with actor identity and UTC timestamp.
- All decision records append-only.

## Regulator Replay Requirements
- Export packet includes:
  - case header snapshot
  - full event timeline
  - evidence manifest with SHA-256 hashes
  - review/override decisions
  - linked freight audit run/result references
- Ordering must be deterministic by event timestamp then event ID.

## Reporting and KPIs
- Open cases by severity and age
- Time-to-first-review
- Time-to-resolution
- Override volume by decision type
- Evidence request completion rate
- Reopened case rate (if introduced in later phase)

## Non-Enforcement Contract
- Admin review outcomes in this phase do not:
  - block settlement initiation
  - block payout completion
  - alter existing route decision branches
- Enforcement remains a separate future activation program.

## Implementation Notes (Phase 6)
- Add `FreightExceptionService` with:
  - `openCaseFromAuditOutcome()`
  - `appendCaseEvent()`
  - `appendCaseEvidence()`
  - `recordAdminDecision()`
  - `resolveCase()`
  - `closeCase()`
- Add admin read APIs for queue and case detail.
- Add export API for replay package generation.

Status: Proposed.  
Implementation: Authorised for non-enforcing admin review and audit visibility.
