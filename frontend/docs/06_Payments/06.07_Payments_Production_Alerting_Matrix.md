# Payments Production Alerting Matrix
Version: v1.0
Date: 2026-02-13
Program: `EXT-PAYMENTS-03`
Status: Operational Handoff

## Scope
This matrix defines production alert operations for payments hardening outcomes delivered in `EXT-PAYMENTS-03`.
It is operations-focused and references existing runbooks for response execution.

Runbook references:
- Reconciliation: `frontend/docs/06_Payments/06.04_Payments_Reconciliation_Runbook.md`
- Metrics + SLOs: `frontend/docs/06_Payments/06.05_Payments_Metrics_and_SLOs.md`
- Formal close context: `frontend/docs/06_Payments/06.06_EXT-PAYMENTS-03_Formal_Close_Pack.md`

## Alert Matrix
| SLO / Signal | WARN Threshold | PAGE Threshold | Evaluation Window | Owner | Escalation Path | TTA (WARN/PAGE) | Primary Action |
|---|---|---|---|---|---|---|---|
| `SLO-STRIPE-CHECKOUT-LATENCY` (p95) | `> 2000ms` and `<= 3000ms` | `> 3000ms` for 10m | Rolling 1h | Payments Ops | Payments Ops -> Platform Reliability -> Incident Commander | 30m / 10m | Validate provider status, inspect idempotency queue growth, confirm retry pressure |
| `SLO-STRIPE-REFUND-LATENCY` (p95) | `> 3000ms` and `<= 5000ms` | `> 5000ms` for 10m | Rolling 1h | Payments Ops | Payments Ops -> Finance Ops -> Platform Reliability | 30m / 10m | Check refund intent backlog, provider API response profile, and webhook completion lag |
| `SLO-WEBHOOK-VERIFY-FAIL-RATE` | `>= 0.5%` and `<= 2%` | `> 2%` for 5m | Rolling 15m | Platform Reliability | Platform Reliability -> Security Duty -> Payments Ops | 20m / 5m | Validate signature secret rotation state and ingress header integrity |
| `SLO-WISE-ACCEPTANCE-LATENCY` (p95) | `> 300000ms` and `<= 600000ms` | `> 600000ms` for 30m | Rolling 24h | Settlements Ops | Settlements Ops -> Payments Ops -> Platform Reliability | 30m / 10m | Check Wise API latency, transfer intent queue age, and acceptance event ingestion |
| `SLO-WISE-COMPLETION-LATENCY` (p95) | `> 3600000ms` and `<= 10800000ms` | `> 10800000ms` for 30m | Rolling 24h | Settlements Ops | Settlements Ops -> Finance Ops -> Platform Reliability | 30m / 10m | Verify webhook/polling continuity and terminal event propagation |
| `SLO-WISE-TIMEOUT-RATE` | `>= 1%` and `<= 2%` | `> 2%` for 15m | Rolling 1h | Settlements Ops | Settlements Ops -> Payments Ops -> Incident Commander | 20m / 5m | Identify timeout cohort, enforce manual override policy, pause automated retries if required |
| `SLO-RECON-CRITICAL-DENSITY` | `>= 1` and `<= 5` per 1000 orders | `> 5` per 1000 orders | Per reconciliation run | Governance + Payments Ops | Governance Duty -> Payments Ops -> Incident Commander | 30m / 10m | Run bounded reconciliation replay, classify dominant discrepancy code, initiate case workflow |
| `SLO-RECON-SETTLEMENT-CONTRADICTION` | n/a | `>= 1` occurrence | Per reconciliation run | Governance + Finance Ops | Governance Duty -> Finance Ops -> Incident Commander | n/a / 5m | Freeze affected payout retries, open manual case immediately |
| `IDENTITY_MISMATCH` discrepancy count | Any non-zero observed | `>= 1` in production run | Per reconciliation run | Security + Governance | Security Duty -> Governance Duty -> Incident Commander | 15m / 5m | Treat as integrity event; lock affected scope and start evidentiary review |

## Escalation Contacts (Role-Based)
- `Payments Ops`: payment lifecycle and Stripe control owner.
- `Settlements Ops`: Wise transfer and payout lifecycle owner.
- `Platform Reliability`: platform incident coordination, route/signature infrastructure.
- `Finance Ops`: settlement and refund reconciliation owner.
- `Governance Duty`: discrepancy/regulatory evidence owner.
- `Security Duty`: signature/auth integrity owner.
- `Incident Commander`: cross-functional command when PAGE criteria persist.

## Alert Routing Rules
- WARN alerts route to functional owner only.
- PAGE alerts route to functional owner + secondary owner + incident channel.
- PAGE auto-escalates to Incident Commander if unresolved after 15 minutes.
- Repeated PAGE (3+ in 60 minutes, same signal) triggers mandatory incident bridge.

## Time-to-Acknowledge (TTA) and Time-to-Mitigation (TTM)
- WARN:
  - TTA target: 30 minutes (20 minutes for webhook signature failures).
  - TTM target: 4 hours or documented risk acceptance.
- PAGE:
  - TTA target: 10 minutes (5 minutes for settlement contradiction / identity mismatch).
  - TTM target: 60 minutes for containment; full remediation tracked via incident ticket.

## False Positive Dampening Rules
- Require two consecutive evaluation intervals before raising WARN for latency-only signals.
- Suppress PAGE if sample size is below minimum data threshold:
  - Stripe latency SLOs: `< 20` operations in window
  - Wise latency SLOs: `< 10` intents in window
- Deduplicate identical alerts by key `{signal, provider, scope}` for 15 minutes.
- Auto-resolve alerts only after two consecutive healthy intervals.
- During approved maintenance windows, route alerts to `maintenance-observe` channel only.
- Do not dampen:
  - `SLO-RECON-SETTLEMENT-CONTRADICTION`
  - `IDENTITY_MISMATCH`

## Incident Evidence Requirements
Each PAGE event must capture:
- `reportHash` (`deterministicHashSha256`) from metrics or reconciliation snapshot
- impacted `orderId` set (if available)
- `provider`, `eventId`, `idempotencyKey` cohort identifiers (if available)
- decision log (containment action + owner + timestamp)

## Operational Guardrails
- Metrics and reconciliation routes remain internal, signed, and feature-flag controlled.
- Alerting signals are advisory and must not mutate payment or settlement state directly.
- Any manual corrective action must follow referenced runbooks and governance approvals.
